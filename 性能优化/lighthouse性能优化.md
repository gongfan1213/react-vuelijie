> ğŸ’­ å—¯ï¼Œç”¨æˆ·ç°åœ¨é—®çš„æ˜¯â€œå¦‚ä½•ä½¿ç”¨Lighthouseæ ¹æ®æ€§èƒ½æŒ‡æ ‡è¿›è¡Œæ€§èƒ½ä¼˜åŒ–â€ã€‚ä¹‹å‰å·²ç»è®¨è®ºäº†æ€§èƒ½æŒ‡æ ‡çš„å…·ä½“å†…å®¹ï¼Œæ‰€ä»¥ä»–ä»¬ç°åœ¨å¯èƒ½æƒ³è¿›ä¸€æ­¥äº†è§£å¦‚ä½•é€šè¿‡å·¥å…·å°†è¿™äº›æŒ‡æ ‡å®é™…åº”ç”¨åœ¨ä¼˜åŒ–å·¥ä½œä¸­ã€‚Lighthouseä½œä¸ºGoogleæ¨èçš„è‡ªåŠ¨æ£€æµ‹å·¥å…·ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªé‡ç‚¹å›ç­”å¯¹è±¡ã€‚
>
> é¦–å…ˆï¼Œæˆ‘éœ€è¦ç¡®è®¤ç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯ã€‚å¯èƒ½ä»–ä»¬æ˜¯å‰ç«¯å¼€å‘è€…ï¼Œæ­£åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™ï¼Œæƒ³è¦é€šè¿‡Lighthouseæµ‹è¯•æ¥æ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œè¿›è€Œä¼˜åŒ–ç½‘ç«™é€Ÿåº¦ã€äº¤äº’ä½“éªŒç­‰ã€‚æˆ–è€…æ˜¯SEOç›¸å…³äººå‘˜ï¼ŒçŸ¥é“æ ¸å¿ƒWebæŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰å¯¹SEOçš„å½±å“ï¼Œæ‰€ä»¥éœ€è¦äº†è§£å¦‚ä½•ç”¨Lighthouseæ¥æå‡è¿™äº›æŒ‡æ ‡ï¼Œæ”¹å–„æœç´¢æ’åã€‚
>
> æ¥ä¸‹æ¥éœ€è¦è€ƒè™‘ç”¨æˆ·çš„éœ€æ±‚å±‚æ¬¡ã€‚ä»–ä»¬å¯èƒ½å¯¹Lighthouseçš„åŸºæœ¬ä½¿ç”¨æœ‰åˆæ­¥äº†è§£ï¼Œä½†ä¸ç¡®å®šå¦‚ä½•æ ¹æ®ç”Ÿæˆçš„æŠ¥å‘Šè¿›è¡Œå…·ä½“ä¼˜åŒ–ã€‚å¯èƒ½éœ€è¦è¯¦ç»†çš„æ­¥éª¤è¯´æ˜ï¼Œæ¯”å¦‚å¦‚ä½•è¿è¡ŒLighthouseã€è§£è¯»æŠ¥å‘Šä¸­çš„å„ä¸ªæŒ‡æ ‡ã€æ¯ä¸ªæŒ‡æ ‡å¯¹åº”çš„ä¼˜åŒ–å»ºè®®ï¼Œä»¥åŠå¦‚ä½•å®æ–½è¿™äº›å»ºè®®ã€‚
>
> ç”¨æˆ·å¯èƒ½å­˜åœ¨çš„æ·±å±‚éœ€æ±‚æ˜¯ï¼Œå¦‚ä½•å°†Lighthouseçš„æ•°æ®è½¬åŒ–ä¸ºå®é™…è¡ŒåŠ¨ï¼Œè€Œä¸ä»…ä»…æ˜¯è·‘ä¸ªæµ‹è¯•çœ‹çœ‹åˆ†æ•°ã€‚å› æ­¤ï¼Œé™¤äº†æ­¥éª¤å¤–ï¼Œè¿˜éœ€è¦ä¸¾ä¾‹è¯´æ˜å…·ä½“ä¼˜åŒ–æªæ–½ï¼Œæ¯”å¦‚é’ˆå¯¹LCPçš„æå‡ç­–ç•¥ï¼Œå¦‚ä½•ä¼˜åŒ–å›¾ç‰‡ã€å‡å°‘é˜»å¡æ¸²æŸ“çš„è„šæœ¬ï¼Œæˆ–è€…é’ˆå¯¹CLSå¦‚ä½•é˜²æ­¢å¸ƒå±€åç§»ã€‚
>
> å¯èƒ½éœ€è¦ç»“æ„åŒ–çš„å›ç­”ï¼Œåˆ†æ­¥éª¤è§£é‡Šï¼Œå¦‚ç”ŸæˆæŠ¥å‘Šã€åˆ†ææŒ‡æ ‡ã€æ‰§è¡Œä¼˜åŒ–ã€éªŒè¯ç»“æœã€‚åŒæ—¶éœ€è¦åŒºåˆ†ä¸åŒçš„æµ‹è¯•ç¯å¢ƒï¼ˆå¦‚ç§»åŠ¨ç«¯ä¸æ¡Œé¢ç«¯ï¼‰ï¼Œä»¥åŠå¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æŒç»­ç›‘æ§ï¼Œè€Œä¸ä»…ä»…æ˜¯æœ¬åœ°æµ‹è¯•ã€‚
>
> è¿˜éœ€è¦æ³¨æ„Lighthouseçš„å±€é™æ€§ï¼Œæ¯”å¦‚æœ¬åœ°è¿è¡Œç»“æœå¯èƒ½ä¸çœŸå®ç”¨æˆ·æ•°æ®ï¼ˆRUMï¼‰å­˜åœ¨å·®å¼‚ï¼Œå¦‚ä½•ç»“åˆå…¶ä»–å·¥å…·å¦‚PageSpeed Insightsã€WebPageTestç­‰ï¼Œæ¥è·å–æ›´å…¨é¢çš„æ•°æ®ã€‚åŒæ—¶æåˆ°æŒç»­é›†æˆï¼ˆCIï¼‰ä¸­çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¦‚å°†Lighthouseé›†æˆåˆ°æ„å»ºæµç¨‹ä¸­ï¼Œé¿å…æ€§èƒ½å›å½’ã€‚
>
> å¦å¤–ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦å…·ä½“çš„ä»£ç ç¤ºä¾‹æˆ–é…ç½®å»ºè®®ï¼Œä¾‹å¦‚å¦‚ä½•è®¾ç½®é¢„åŠ è½½ã€å¦‚ä½•æ‹†åˆ†é•¿ä»»åŠ¡ï¼Œå¦‚ä½•åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ç­‰ã€‚æä¾›å®é™…çš„ä¼˜åŒ–æ–¹æ³•ä¼šå¢åŠ å›ç­”çš„å®ç”¨ä»·å€¼ã€‚
>
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨æˆ·å¯èƒ½åœ¨å®è·µä¸­é‡åˆ°Lighthouseåˆ†æ•°æ³¢åŠ¨çš„é—®é¢˜ï¼Œæ¯”å¦‚åŒä¸€é¡µé¢å¤šæ¬¡æµ‹è¯•ç»“æœä¸åŒï¼Œè¿™å¯èƒ½éœ€è¦è§£é‡Šç½‘ç»œç¯å¢ƒã€ç¼“å­˜çŠ¶æ€æˆ–å…¶ä»–å¤–éƒ¨å› ç´ å¯¹ç»“æœçš„å½±å“ï¼Œå»ºè®®è¿›è¡Œå¤šæ¬¡æµ‹è¯•å¹¶å–å¹³å‡å€¼ã€‚
>
> æœ€åï¼Œåº”è¯¥æ€»ç»“ä¸€ä¸ªæ¸…æ™°çš„æµç¨‹ï¼Œå¸®åŠ©ç”¨æˆ·ä»æµ‹è¯•åˆ°ä¼˜åŒ–å†åˆ°éªŒè¯ï¼Œå½¢æˆä¸€ä¸ªé—­ç¯ï¼Œç¡®ä¿ä»–ä»¬èƒ½å¤Ÿç³»ç»Ÿåœ°åº”ç”¨è¿™äº›æ–¹æ³•æé«˜ç½‘ç«™æ€§èƒ½ã€‚
>
> 



ä½¿ç”¨ Lighthouse è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ª**ç³»ç»Ÿæ€§å·¥ç¨‹**ï¼Œéœ€ç»“åˆå…¶æä¾›çš„**è¯Šæ–­æŠ¥å‘Š**å’Œ**å¯æ“ä½œå»ºè®®**é€æ­¥æ”¹è¿›å…³é”®æ€§èƒ½æŒ‡æ ‡ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤å’Œå®æˆ˜æŠ€å·§ï¼š

---

### **ä¸€ã€ç”Ÿæˆ Lighthouse æŠ¥å‘Š**
#### 1. **è¿è¡Œæ–¹å¼**  
- **æµè§ˆå™¨æ‰©å±•**ï¼š  
  Chrome æ’ä»¶ç›´æ¥ç‚¹å‡» **Generate report**ã€‚  
  <img src="https://developer.chrome.com/static/images/devtools/lighthouse-step-2.png" width="400" alt="Lighthouseæ‰©å±•æ“ä½œ">  

- **DevTools é›†æˆ**ï¼š  
  Chrome DevTools â†’ Lighthouse é¢æ¿ â†’ é€‰æ‹© **Performance ç±»åˆ«** + è®¾å¤‡ç±»å‹ï¼ˆMobile/Desktopï¼‰ã€‚  

- **å‘½ä»¤è¡Œï¼ˆCI/CD é›†æˆï¼‰**ï¼š  
  ```bash
  npm install -g lighthouse
  lighthouse https://example.com --view --preset=desktop
  ```

#### 2. **å‚æ•°é…ç½®**  
- `--throttling`: æ¨¡æ‹Ÿç½‘ç»œé™åˆ¶ï¼ˆå¦‚ 4Gï¼‰ï¼Œå»ºè®®æµ‹è¯•ç§»åŠ¨ç«¯æ—¶å¯ç”¨ã€‚  
- `--preset=perf`: ä»…é‡‡é›†æ€§èƒ½æ•°æ®ï¼ˆè·³è¿‡ SEOã€å¯è®¿é—®æ€§ç­‰ï¼‰ã€‚  

---

### **äºŒã€æ ¸å¿ƒæŒ‡æ ‡è§£è¯»ä¸ä¼˜åŒ–ç­–ç•¥**
Lighthouse ç›´æ¥å…³è” Google çš„ **Core Web Vitals**ï¼ˆLCPã€FIDã€CLSï¼‰ï¼Œå¹¶é€šè¿‡ **Opportunities** å’Œ **Diagnostics** æä¾›ä¼˜åŒ–æ–¹å‘ã€‚

#### **1. LCP (æœ€å¤§å†…å®¹ç»˜åˆ¶)**  
- **å¸¸è§é—®é¢˜**ï¼š  
  - æœªå‹ç¼©å¤§å›¾ï¼ˆå¦‚ 4000x3000 çš„ JPG ç›´æ¥æ¸²æŸ“ä¸º 300x200 ç¼©ç•¥å›¾ï¼‰ã€‚  
  - å…³é”®èµ„æºåŠ è½½è¢«é˜»å¡ï¼ˆå¦‚æœªé¢„åŠ è½½å­—ä½“ã€JavaScript åŒæ­¥åŠ è½½ï¼‰ã€‚  

- **ä¼˜åŒ–ç¤ºä¾‹**ï¼š  
  ```html
  <!-- ä½¿ç”¨å“åº”å¼å›¾ç‰‡ + WebP æ ¼å¼ -->
  <img src="hero.webp" 
       srcset="hero-sm.webp 480w, hero-md.webp 768w" 
       sizes="(max-width: 600px) 480px, 768px" 
       alt="Hero Image">
  
  <!-- é¢„åŠ è½½å…³é”®å­—ä½“ -->
  <link rel="preload" href="font.woff2" as="font" crossorigin>
  ```

#### **2. CLS (ç´¯ç§¯å¸ƒå±€åç§»)**  
- **å¸¸è§é—®é¢˜**ï¼š  
  - åŠ¨æ€æ’å…¥å¹¿å‘Š/å¼¹çª—å¯¼è‡´é¡µé¢å¸ƒå±€è·³åŠ¨ã€‚  
  - æœªå®šä¹‰å›¾ç‰‡æˆ– iframe çš„å°ºå¯¸ï¼ˆåŠ è½½åçªç„¶æ’‘å¼€å†…å®¹ï¼‰ã€‚  

- **ä¼˜åŒ–ç¤ºä¾‹**ï¼š  
  ```css
  /* å¼ºåˆ¶ä¸ºåŠ¨æ€å†…å®¹é¢„ç•™ç©ºé—´ */
  .ad-container {
    width: 300px;
    height: 250px; /* å³ä½¿å¹¿å‘ŠæœªåŠ è½½ï¼Œé¢„ç•™ç›¸åº”é«˜åº¦ */
  }
  
  img {
    aspect-ratio: 16/9; /* æ ¹æ®å›¾ç‰‡æ¯”ä¾‹å›ºå®šå®¹å™¨é«˜å®½æ¯” */
  }
  ```

#### **3. TBT (Total Blocking Timeï¼Œæ€»é˜»å¡æ—¶é—´)**  
- **å…³è”æŒ‡æ ‡**ï¼šç›´æ¥å½±å“ FIDï¼ˆé¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼‰ã€‚  
- **åˆ†æå·¥å…·**ï¼š  
  Chrome DevTools â†’ Performance é¢æ¿ â†’ æŸ¥æ‰¾ä¸»çº¿ç¨‹ä¸­è€—æ—¶è¶…è¿‡ **50ms** çš„â€œé•¿ä»»åŠ¡â€ï¼ˆæ ‡ä¸ºçº¢è‰²ï¼‰ã€‚  

- **ä¼˜åŒ–ç¤ºä¾‹**ï¼š  
  ```javascript
  // å°†å¤æ‚è®¡ç®—æ‹†åˆ†åˆ°ç©ºé—²æ—¶æ®µ
  function processData() {
    const data = /* ... */;
    requestIdleCallback(() => {
      // åˆ†è§£ä¸ºå¤šä¸ªå°å—
      for (let i = 0; i < data.length; i += 100) {
        const chunk = data.slice(i, i + 100);
        setTimeout(() => processChunk(chunk));
      }
    });
  }
  ```

---

### **ä¸‰ã€å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼šåˆ©ç”¨ Lighthouse å»ºè®®**
æŠ¥å‘Šä¸­çš„ **Opportunities** å’Œ **Diagnostics** ä¼šç›´æ¥åˆ—å‡ºå¯é‡åŒ–æ”¹è¿›ç‚¹ã€‚

#### **1. å‹ç¼©é™æ€èµ„æº**  
- **å…¸å‹å»ºè®®**ï¼š  
  ```text
  Serve images in next-gen formats (Potential savings: 220 KB) 
  ```
  
- **æ“ä½œæ­¥éª¤**ï¼š  
  - ä½¿ç”¨ **Squoosh**ï¼ˆWeb å·¥å…·ï¼‰æˆ– **Sharp**ï¼ˆNode åº“ï¼‰å°† JPG/PNG è½¬æ¢ä¸º WebP/AVIFã€‚  
  - é…ç½® CDN è‡ªåŠ¨æ ¼å¼è½¬æ¢ï¼ˆå¦‚ Cloudflare çš„ [Polish](https://developers.cloudflare.com/images/polish/)ï¼‰ã€‚  

#### **2. æ¶ˆé™¤æ¸²æŸ“é˜»å¡èµ„æº**  
- **è¯Šæ–­ç»“æœ**ï¼š  
  ```text
  Remove unused JavaScript (3.2s saved)  
  ```
  
- **ä¼˜åŒ–æ‰‹æ®µ**ï¼š  
  - ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰ï¼š  
    ```javascript
    // åŠ¨æ€å¯¼å…¥éå…³é”®æ¨¡å—
    import('non-critical-module.js').then(module => module.init());
    ```
  - æ¸…ç†å†—ä½™ä¾èµ–ï¼ˆä½¿ç”¨ `webpack-bundle-analyzer`ï¼‰ã€‚

#### **3. æå‡æœåŠ¡å™¨å“åº”é€Ÿåº¦**  
- **å»ºè®®æç¤º**ï¼š  
  ```text
  Reduce server response time (TTFB)  
  ```
  
- **æŠ€æœ¯æ–¹æ¡ˆ**ï¼š  
  - è¾¹ç¼˜ç¼“å­˜ï¼ˆVercelã€Netlify ç­‰æ‰˜ç®¡å¹³å°è‡ªåŠ¨ä¼˜åŒ–ï¼‰ã€‚  
  - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ï¼ˆæ·»åŠ ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æï¼‰ã€‚  

---

### **å››ã€æ·±åº¦ä¼˜åŒ–ï¼šåŸºäº Lighthouse æºç çš„è‡ªå®šä¹‰è§„åˆ™**  
Lighthouse çš„å®¡è®¡è§„åˆ™å®Œå…¨å¼€æºï¼ˆ[GitHub](https://github.com/GoogleChrome/lighthouse)ï¼‰ï¼Œå¯æ‰©å±•æˆ–è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘ã€‚

#### ç¤ºä¾‹ï¼šæ£€æµ‹æœªç»ä¼˜åŒ–çš„ CSS åŠ¨ç”»  
```javascript
// è‡ªå®šä¹‰å®¡è®¡è§„åˆ™ (my-audit.js)
class CheckAnimationPerformance extends Audit {
  static get meta() {
    return {
      id: 'animation-audit',
      title: 'CSSåŠ¨ç”»ä¼˜åŒ–æ£€æµ‹',
      failureTitle: 'æ£€æµ‹åˆ°æ€§èƒ½ä¸ä½³çš„ CSS åŠ¨ç”»å±æ€§',
      description: 'é¿å…ä½¿ç”¨ margin ç­‰è§¦å‘å¸ƒå±€å˜åŒ–çš„å±æ€§åˆ¶ä½œåŠ¨ç”»',
      requiredArtifacts: ['CSSUsage'],
    };
  }

  static audit(artifacts) {
    const cssUsage = artifacts.CSSUsage;
    const badProperties = ['margin', 'padding', 'width'];
    const offenders = [];

    Object.entries(cssUsage).forEach(([stylesheet, rules]) => {
      rules.forEach(rule => {
        if (rule.animationNames.length > 0) {
          rule.declarations.forEach(decl => {
            if (badProperties.includes(decl.property)) {
              offenders.push(`åŠ¨ç”»ä¸­ä½¿ç”¨äº† ${decl.property}`);
            }
          });
        }
      });
    });

    return {
      score: offenders.length === 0 ? 1 : 0,
      details: Audit.makeTableDetails({
        headings: [{ key: 'msg', text: 'é—®é¢˜' }],
        items: offenders.map(msg => ({ msg })),
      }),
    };
  }
}
```

è¿è¡Œè‡ªå®šä¹‰è§„åˆ™ï¼š  
```bash
lighthouse https://example.com --plugins=./my-audit.js
```

---

### **äº”ã€è‡ªåŠ¨åŒ–æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ**  
å°† Lighthouse é›†æˆåˆ°å¼€å‘æµç¨‹ä¸­ï¼Œé˜²æ­¢æ€§èƒ½é€€åŒ–ã€‚

#### **1. GitHub Actions æŒç»­æ£€æµ‹**  
```yaml
name: Performance Check
on: [push]
jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: treosh/lighthouse-ci-action@v9
        with:
          urls: https://example.com
          configPath: .lighthouserc.json
          uploadArtifacts: true # å°†æŠ¥å‘Šå½’æ¡£åˆ° GitHub
```

#### **2. é…ç½®é˜ˆå€¼æŠ¥è­¦ï¼ˆ.lighthouserc.jsonï¼‰**  
```json
{
  "ci": {
    "collect": { "url": ["https://example.com"] },
    "assert": {
      "preset": "lighthouse:no-pwa",
      "assertions": {
        "largest-contentful-paint": ["error", { "maxNumericValue": 2500 }],
        "cumulative-layout-shift": ["error", { "maxNumericValue": 0.1 }]
      }
    }
  }
}
```

---

### **å…­ã€éªŒè¯ä¼˜åŒ–æ•ˆæœ**  
1. **å¤šç¯å¢ƒå¯¹æ¯”**ï¼šæµ‹è¯•ä¸åŒç½‘ç»œæ¡ä»¶ï¼ˆFast 3Gã€4Gï¼‰ã€è®¾å¤‡ï¼ˆMoto G4ã€iPhone 12ï¼‰ã€‚  
2. **å‰åæŠ¥å‘Šå¯¹æ¯”**ï¼šä½¿ç”¨ Lighthouse çš„ **View Comparisons** åŠŸèƒ½ç›´è§‚æµ‹è¯„åˆ†æ•°å˜åŒ–ã€‚  
3. **çœŸå®ç”¨æˆ·ç›‘æ§ï¼ˆRUMï¼‰**ï¼šæ¥å…¥ **Google Analytics 4 + BigQuery**ï¼Œç›‘æ§ç”Ÿäº§ç¯å¢ƒçš„ Core Web Vitalsã€‚  

---

### **æ€»ç»“**  
Lighthouse ä¸ä»…æ˜¯æ£€æµ‹å·¥å…·ï¼Œæ›´æ˜¯ä¼˜åŒ–æŒ‡å—é’ˆï¼š  
- **ç²¾å‡†å®šä½** æ¸²æŸ“é˜»å¡èµ„æºã€å¸ƒå±€åç§»ç­‰ç¡¬ä¼¤ã€‚  
- **ç»“åˆæ¡†æ¶**ï¼šNext.jsã€Nuxt ç­‰å·²å†…ç½®æœ€ä½³å®è·µï¼ˆå¦‚è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–ï¼‰ã€‚  
- **æŒç»­è¿½è¸ª**ï¼šé€šè¿‡ CI/CDã€RUM é˜²æ­¢æ€§èƒ½å›é€€ã€‚  
- **è¿›é˜¶ç­–ç•¥**ï¼šè‡ªå®šä¹‰å®¡è®¡è§„åˆ™ + è¾¹ç¼˜ç¼“å­˜æå‡ TTFBã€‚
