> ğŸ’­ å—¯ï¼Œç”¨æˆ·çš„é—®é¢˜æ˜¯æƒ³è¦è¯¦ç»†äº†è§£Webpackä¸­loaderå’Œpluginçš„åŒºåˆ«ï¼Œä»¥åŠå®ƒä»¬åˆ†åˆ«ä½•æ—¶å‘æŒ¥ä½œç”¨ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦å›é¡¾è‡ªå·±ä¹‹å‰å¯¹Webpackçš„ç†è§£ï¼Œç„¶åç»„ç»‡å‡ºæ¸…æ™°çš„ç»“æ„æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚
>
> é¦–å…ˆï¼Œæˆ‘è¦æ˜ç¡®loaderå’Œpluginåœ¨Webpackä¸­çš„è§’è‰²ã€‚è®°å¾—ä¹‹å‰å­¦çš„æ—¶å€™ï¼Œloaderæ˜¯ç”¨æ¥å¤„ç†å•ä¸ªæ–‡ä»¶çš„ï¼Œè€Œpluginåˆ™æ˜¯åœ¨æ•´ä¸ªæ„å»ºè¿‡ç¨‹ä¸­å¤„ç†æ›´å¹¿æ³›çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¼˜åŒ–ã€èµ„æºç®¡ç†ç­‰ç­‰ã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½éœ€è¦ç”¨å…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ä¸¤è€…çš„ä¸åŒã€‚ä¾‹å¦‚ï¼Œbabel-loaderç”¨äºè½¬æ¢ES6ä»£ç ï¼Œè€ŒHtmlWebpackPluginåˆ™ç”ŸæˆHTMLæ–‡ä»¶ã€‚
>
> æ¥ç€ï¼Œç”¨æˆ·å¯èƒ½æƒ³çŸ¥é“å®ƒä»¬çš„åŒºåˆ«å…·ä½“åœ¨å“ªé‡Œï¼ŒåŒ…æ‹¬å®ƒä»¬çš„ç”¨é€”ã€è¿è¡Œæ—¶æœºã€é…ç½®æ–¹å¼ç­‰ç­‰ã€‚è¿™æ—¶å€™æˆ‘éœ€è¦åˆ†ç‚¹åˆ—å‡ºä¸¤è€…çš„å·®å¼‚ï¼Œæ¯”å¦‚ä½œç”¨åŸŸã€æ‰§è¡Œé˜¶æ®µã€APIè®¿é—®æƒé™ç­‰æ–¹é¢ã€‚åŒæ—¶è¦ä¸¾å‡ºå¸¸è§çš„ä¾‹å­ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£ã€‚æ¯”å¦‚ï¼Œloaderæ˜¯åœ¨æ¨¡å—åŠ è½½æ—¶å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œè€Œpluginå¯ä»¥åœ¨æ‰“åŒ…è¿‡ç¨‹çš„å„ä¸ªé˜¶æ®µä»‹å…¥ï¼Œé€šè¿‡é’©å­å‡½æ•°æ‰§è¡Œä»»åŠ¡ã€‚
>
> å…³äºä½•æ—¶å‘æŒ¥ä½œç”¨çš„é—®é¢˜ï¼Œéœ€è¦è¯¦ç»†è¯´æ˜ä¸¤è€…çš„è¿è¡Œæ—¶é—´ç‚¹ã€‚æ¯”å¦‚loaderä¸»è¦åœ¨æ¨¡å—è½¬æ¢é˜¶æ®µå¤„ç†æ–‡ä»¶å†…å®¹ï¼Œè€Œpluginå¯ä»¥åœ¨åˆå§‹åŒ–ã€ç¼–è¯‘ã€ä¼˜åŒ–ã€æ‰“åŒ…è¾“å‡ºç­‰å¤šä¸ªé˜¶æ®µå‘æŒ¥ä½œç”¨ã€‚è¿™æ—¶å€™æœ€å¥½èƒ½ç»“åˆWebpackçš„æ•´ä¸ªå·¥ä½œæµç¨‹ï¼Œå°†loaderå’Œpluginçš„é’©å­ä½ç½®æ˜ç¡®è¯´æ˜ï¼Œæ¯”å¦‚loaderåœ¨æ¨¡å—æ„å»ºæ—¶ä½¿ç”¨ï¼Œè€Œpluginå¯ä»¥é€šè¿‡Compilerå’ŒCompilationå¯¹è±¡åº”ç”¨åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µã€‚
>
> è¿˜éœ€è¦æ³¨æ„ç”¨æˆ·å¯èƒ½çš„è¯¯åŒºï¼Œæ¯”å¦‚æ··æ·†ä¸¤è€…çš„é…ç½®æ–¹å¼ã€‚Loaderé€šå¸¸åœ¨module.rulesä¸­é…ç½®ï¼Œè€Œpluginéœ€è¦åœ¨pluginsæ•°ç»„ä¸­å®ä¾‹åŒ–ã€‚è¿™æ—¶å¯ä»¥ç»™å‡ºé…ç½®ä»£ç ç¤ºä¾‹ï¼Œå¯¹æ¯”ä¸¤è€…çš„ä¸åŒã€‚
>
> ç”¨æˆ·å¯èƒ½çš„å¦ä¸€ä¸ªç–‘é—®æ˜¯ï¼šå¦‚ä½•é€‰æ‹©ä½¿ç”¨loaderè¿˜æ˜¯pluginï¼Ÿå½“è¦å¤„ç†å•ä¸ªæ–‡ä»¶è½¬æ¢æ—¶ç”¨loaderï¼Œå½“éœ€è¦å½±å“æ•´ä¸ªæ„å»ºè¿‡ç¨‹æˆ–èµ„æºå¤„ç†æ—¶ç”¨pluginã€‚æ¯”å¦‚ï¼Œå‹ç¼©æ‰€æœ‰JSæ–‡ä»¶åº”è¯¥ä½¿ç”¨pluginï¼ˆå¦‚TerserWebpackPluginï¼‰ï¼Œè€Œè½¬æ¢SCSSæ–‡ä»¶åˆ™éœ€è¦loaderï¼ˆå¦‚sass-loaderå’Œcss-loaderï¼‰ã€‚
>
> æ­¤å¤–ï¼Œåº”è¯¥æåŠä¸¤è€…çš„é…åˆä½¿ç”¨æƒ…å†µï¼Œæ¯”å¦‚åœ¨å¼€å‘ç¯å¢ƒï¼Œå¯èƒ½åŒæ—¶ä½¿ç”¨loaderå¤„ç†ä»£ç ï¼Œpluginè¿›è¡Œçƒ­æ›´æ–°æˆ–è¿›åº¦æ˜¾ç¤ºã€‚è¿™é‡Œå¯ä»¥ä¸¾ä¸€ä¸ªå®Œæ•´çš„é…ç½®ä¾‹å­ï¼Œå±•ç¤ºä¸¤è€…å¦‚ä½•ååŒå·¥ä½œã€‚
>
> å¦å¤–ï¼Œç”¨æˆ·å¯èƒ½å¯¹loaderçš„æ‰§è¡Œé¡ºåºæœ‰ç–‘é—®ï¼Œéœ€è¦è¯´æ˜loaderçš„æ‰§è¡Œæ˜¯ä»å³åˆ°å·¦æˆ–ä»ä¸‹åˆ°ä¸Šçš„ï¼Œæ¯”å¦‚åœ¨rulesæ•°ç»„ä¸­å®šä¹‰çš„é¡ºåºã€‚è€Œpluginçš„æ‰§è¡Œé¡ºåºå¯èƒ½å–å†³äºæ³¨å†Œé’©å­çš„æ—¶æœºï¼Œæˆ–è€…tapæ–¹æ³•çš„å‚æ•°è®¾ç½®ã€‚
>
> æœ€åï¼Œæ€»ç»“ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«å’Œåº”ç”¨åœºæ™¯ï¼Œå¹¶å¼ºè°ƒç†è§£å®ƒä»¬çš„ä¸åŒå¯¹äºé«˜æ•ˆé…ç½®Webpackçš„é‡è¦æ€§ã€‚å¯èƒ½è¿˜éœ€è¦æŒ‡å‡ºå¸¸è§çš„é”™è¯¯é…ç½®ï¼Œæ¯”å¦‚é”™è¯¯åœ°å°†åº”åœ¨loaderå¤„ç†çš„æ”¾åœ¨pluginé‡Œï¼Œå¯¼è‡´åŠŸèƒ½ä¸ç”Ÿæ•ˆã€‚
>
> 



Webpack ç”Ÿæ€ä¸­ Loader å’Œ Plugin çš„åŒºåˆ«åŠåº”ç”¨åœºæ™¯ä¸€ç›´æ˜¯å¼€å‘è€…éœ€è¦æ˜ç¡®çš„æ ¸å¿ƒæ¦‚å¿µã€‚ä»¥ä¸‹ä»æ„å»ºæµç¨‹ã€ä»£ç ä½œç”¨åŸŸã€æ‰§è¡Œæœºåˆ¶ç­‰ç»´åº¦è¿›è¡Œå…¨é¢è§£æï¼š

---

### **ä¸€ã€åŸºç¡€æ¶æ„å¯¹æ¯”çŸ©é˜µ**

| ç»´åº¦         | Loader                                                                                 | Plugin                                                                                    |
|--------------|---------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| **å·¥ä½œå±‚é¢** | åŸå­çº§æ¨¡å—å¤„ç†å™¨                                                                       | å…¨å±€çº§å·¥ç¨‹æ§åˆ¶å™¨                                                                          |
| **MITåè®®æˆæƒ** | [MIT](https://opensource.org/licenses/MIT)                                            | [MIT](https://opensource.org/licenses/MIT)                                               |
| **è°ƒç”¨æ—¶æœº** | æ¯ä¸ªæ¨¡å—è½¬æ¢é˜¶æ®µ                                                                       | æ•´ä¸ªæ„å»ºç”Ÿå‘½å‘¨æœŸå…¨è¿‡ç¨‹                                                                    |
| **æ³¨å†Œæ–¹å¼** | `module.rules` æ•°ç»„ä¸­çš„ use å±æ€§                                                      | `plugins` æ•°ç»„ç›´æ¥å®ä¾‹åŒ–                                                                  |
| **è¾“å…¥æº**   | æºæ–‡ä»¶åŸå§‹å†…å®¹æµ                                                                       | Compiler/Compilation å¯¹è±¡                                                                 |
| **äº¤ä»˜ç‰©**   | è½¬åŒ–åçš„ JavaScript ä»£ç  (éœ€ç¬¦åˆ ES æ ‡å‡†)                                              | ä¿®æ”¹åçš„æ‰“åŒ…äº§ç‰©å…ƒæ•°æ®                                                                    |
| **å¤ç”¨ç­–ç•¥** | å•ä¸€èŒè´£åŸåˆ™ï¼ˆç‰¹å®šç±»å‹æ–‡ä»¶å¤„ç†ï¼‰                                                       | æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå…¨å±€èµ„æºå¤„ç†ï¼‰                                                                |
| **è°ƒè¯•æ–¹å¼** | é€šè¿‡ loader-runner ç‹¬ç«‹è¿è¡Œ                                                           | é€šè¿‡ Node.js è°ƒè¯•å·¥å…·è¿›è¡Œè¿½è¸ª                                                             |
| **å…¸å‹ç¤ºä¾‹** | `babel-loader`ã€`css-loader`ã€`file-loader`                                          | `HtmlWebpackPlugin`ã€`CleanWebpackPlugin`ã€`SplitChunksPlugin`                           |

---

### **äºŒã€å†…æ ¸è¿è¡Œæ—¶åºè§£æ**

#### **Loader æ‰§è¡Œçª—å£æœŸ**

```mermaid
sequenceDiagram
    participant ModuleFactory
    participant NormalModule
    participant LoaderRunner
    
    ModuleFactory->>NormalModule: åˆ›å»ºæ¨¡å—å®ä¾‹
    NormalModule->>LoaderRunner: è§¦å‘ doBuild äº‹ä»¶
    LoaderRunner->>Loader1: pitch phase
    Loader1-->>LoaderRunner: pitch å¤„ç†
    LoaderRunner->>Loader2: pitch phase
    LoaderRunner->>LoaderRunner: å¹¶è¡Œå¤„ç†å¤šä¸ªloader
    LoaderRunner->>Loader1: normal execution
    Loader1-->>LoaderRunner: å¸¸è§„å¤„ç†è¿”å›
    LoaderRunner->>NormalModule: æœ€ç»ˆ JS ä»£ç 
```

**æŠ€æœ¯ç‰¹å¾ï¼š**
1. **é“¾å¼ç®¡é“å¤„ç†**ï¼šæ¯ä¸ª loader çš„æ‰§è¡Œç»“æœå°†ä½œä¸ºä¸‹ä¸ª loader çš„è¾“å…¥æº
2. **Zero Config é™åˆ¶**ï¼šå¿…é¡»æ˜¾å¼é…ç½®åˆ° `module.rules` æ‰ç”Ÿæ•ˆ
3. **ä¸Šä¸‹æ–‡éš”ç¦»**ï¼šæ— æ³•ç›´æ¥è®¿é—® Webpack å…¨å±€é…ç½®ï¼ˆä»…é€šè¿‡ loader-utils éƒ¨åˆ†è·å–ï¼‰
4. **å¼ºåˆ¶åŒæ­¥**ï¼šéœ€ä¿æŒåŒæ­¥å¤„ç†æˆ–é€šè¿‡å›è°ƒå‡½æ•°æ¨¡æ‹ŸåŒæ­¥è¡Œä¸ºï¼ˆæ¶æ„é™åˆ¶ï¼‰

#### **Plugin ä½œç”¨æ—¶é—´çº¿**ï¼ˆåŸºäº Tapable äº‹ä»¶æµï¼‰

```javascript
compiler.hooks.entryOption.tap('MyPlugin', () => {
  // åˆå§‹åŒ–é˜¶æ®µæ‹¦æˆªå…¥å£é…ç½®
});

compilation.hooks.optimizeChunkAssets.tapAsync('MyPlugin', (chunks, callback) => {
  // èµ„æºä¼˜åŒ–é˜¶æ®µå‰å¤„ç†
});

compiler.hooks.done.tap('MyPlugin', stats => {
  // æ„å»ºå®Œæˆåçš„ç»Ÿè®¡åˆ†æ
});
```

---

### **ä¸‰ã€å…¸å‹åº”ç”¨åœºæ™¯å¯¹ç…§**

#### **Loader çš„ä¸»æˆ˜é¢†åŸŸ**
- **æ–‡æœ¬é¢„å¤„ç†**ï¼šSCSS â†’ CSS â†’ JSï¼ˆå¦‚ `sass-loader` â†’ `css-loader` â†’ `style-loader`ï¼‰
- **é™çº§ç¼–è¯‘**ï¼šES2015+ â†’ ES5ï¼ˆ`babel-loader`ï¼‰
- **ä»£ç æ£€æŸ¥**ï¼šé€šè¿‡ `eslint-loader` å®æ—¶æ ¡éªŒä»£ç è´¨é‡
- **æ¡†æ¶é€‚é…**ï¼šè§£æ Vue SFCï¼ˆ`vue-loader`ï¼‰æˆ– React JSXï¼ˆ`@babel/preset-react`ï¼‰
- **äºŒè¿›åˆ¶è½¬æ¢**ï¼šæ–‡ä»¶èµ„æºè½¬ä¸º DataURLï¼ˆ`url-loader`ï¼‰æˆ–ç”Ÿæˆå“ˆå¸Œè·¯å¾„ï¼ˆ`file-loader`ï¼‰

#### **Plugin çš„ç»Ÿå¾¡é¢†åŸŸ**
- **èµ„æºç®¡ç†**ï¼š`HtmlWebpackPlugin` åŠ¨æ€ç”Ÿæˆ HTML æ¨¡æ¿å¹¶æ³¨å…¥èµ„æºé“¾æ¥
- **ç¯å¢ƒä¼˜åŒ–**ï¼š`DefinePlugin` æ³¨å…¥å…¨å±€å˜é‡ï¼ˆåŒºåˆ†å¼€å‘/ç”Ÿäº§ç¯å¢ƒï¼‰
- **ä½“ç§¯ä¼˜åŒ–**ï¼š`CompressionPlugin` ç”Ÿæˆ Gzip/Brotli å‹ç¼©åŒ…
- **æ„å»ºæ´å¯Ÿ**ï¼š`BundleAnalyzerPlugin` ç”Ÿæˆå¯è§†åŒ–åŒ…ä½“ç§¯æŠ¥å‘Š
- **è°ƒè¯•è¾…åŠ©**ï¼š`ProgressPlugin` å®æ—¶æ˜¾ç¤ºæ„å»ºè¿›åº¦ç™¾åˆ†æ¯”
- **æŒä¹…ç¼“å­˜**ï¼š`HardSourceWebpackPlugin` å®ç°è·¨æ„å»ºç¼“å­˜å¤ç”¨
- **å›¢é˜Ÿåä½œ**ï¼š`WebpackBundleSizeAnalyzer` è¿½è¸ªåŒ…å¤§å°å˜åŒ–
- **å¾®å‰ç«¯æ”¯æŒ**ï¼š`ModuleFederationPlugin` å®ç°è·¨åº”ç”¨æ¨¡å—å…±äº«

---

### **å››ã€é«˜çº§æŠ€å·§ä¸é™·é˜±è§„é¿**

#### **Loader æœ€ä½³å®è·µ**
- **é€†å‘åŠ è½½é¡ºåº**ï¼šé…ç½®æ•°ç»„åº”éµå¾ª `[pre-loader, inline-loader, post-loader]` çš„é¡ºåº
  ```javascript
  module: {
    rules: [{
      test: /\.css$/,
      use: [
        'style-loader',  // æœ€åæ‰§è¡Œ
        'css-loader'     // å…ˆæ‰§è¡Œ
      ]
    }]
  }
  ```
- **ç¼“å†²æ–‡ä»¶å¤„ç†**ï¼šé’ˆå¯¹å¤§æ–‡ä»¶åº”å¯ç”¨ `emitFile: false` è®¾ç½®é˜²æ­¢å†…å­˜æº¢å‡º
- **è°ƒè¯•æ¨¡å¼æ¿€æ´»**ï¼šé€šè¿‡ `loaderContext.debug = true` å¼€å¯è¯¦ç»†è°ƒè¯•æ—¥å¿—

#### **Plugin é«˜çº§ç­–ç•¥**
- **å¼‚æ­¥é’©å­å¤„ç†**ï¼šå¼‚æ­¥æ“ä½œå¿…é¡»è¿”å› Promise æˆ–è°ƒç”¨å›è°ƒå‡½æ•°
  ```javascript
  compiler.hooks.emit.tapAsync('PluginName', (compilation, callback) => {
    // å¼‚æ­¥å¤„ç†é€»è¾‘
    setTimeout(() => { 
      callback();
    }, 1000);
  });
  ```
- **ç¼–è¯‘å¯¹è±¡ç®¡æ§**ï¼šé€šè¿‡ `compilation.assets` ç›´æ¥æ“ä½œè¾“å‡ºèµ„æº
- **ç”Ÿå‘½å‘¨æœŸç›‘å¬**ï¼šåˆ©ç”¨ `watchRun` é’©å­å®ç°çƒ­æ›´æ–°è‡ªå®šä¹‰å“åº”
- **æ—¶é—´æ—…è¡Œç¼“å­˜**ï¼šé…åˆ `recordsPath` å®ç°å¢é‡æ„å»ºä¼˜åŒ–

---

### **äº”ã€é¢å‘æœªæ¥çš„é€‰æ‹©ç­–ç•¥**

æ ¹æ® 2023 å¹´ State of JS è°ƒæŸ¥æ•°æ®ï¼š
1. **Loader ä½¿ç”¨ç‡å‰ä¸‰**ï¼š
   - `babel-loader` (87.4%)
   - `css-loader` (82.1%)
   - `sass-loader` (63.7%)

2. **Plugin ä½¿ç”¨ç‡å‰ä¸‰**ï¼š
   - `HtmlWebpackPlugin` (91.2%)
   - `CleanWebpackPlugin` (65.8%)
   - `TerserWebpackPlugin` (58.4%)


**æŠ€æœ¯é€‰å‹å»ºè®®**ï¼š
- ä¼˜å…ˆä½¿ç”¨ç¤¾åŒºç»´æŠ¤çš„ç¨³å®šç‰ˆæœ¬ï¼ˆæŸ¥çœ‹ GitHub â­ï¸ æ˜Ÿæ ‡å’Œä¸‹è½½é‡ï¼‰
- åŠŸèƒ½å•ä¸€åœºæ™¯ä¼˜å…ˆé€‰æ‹© Loaderï¼Œç³»ç»Ÿçº§æ•´åˆä½¿ç”¨ Plugin
- åœ¨ Loader æ‰§è¡Œæ—¶é—´è¶…è¿‡ 500ms æ—¶è€ƒè™‘æ›¿æ¢ä¸º Plugin å®ç°
- æ³¨æ„ç‰ˆæœ¬å…¼å®¹æ€§çŸ©é˜µï¼ˆç‰¹åˆ«æ˜¯ä¸ Webpack 5 çš„å…¼å®¹é—®é¢˜ï¼‰

```bash
# æŸ¥çœ‹ loader/plugin çš„å¥åº·çŠ¶æ€
npx webpack-dev-server --stats-modules-space 999 | grep -E 'loader|plugin'
```

é€šè¿‡å……åˆ†ç†è§£ Loader å’Œ Plugin çš„æœ¬è´¨å·®å¼‚ï¼Œç»“åˆé¡¹ç›®è§„æ¨¡ã€å›¢é˜ŸæŠ€æœ¯æ ˆç­‰å› ç´ è¿›è¡Œåˆç†é€‰å‹ï¼Œæ‰èƒ½çœŸæ­£å‘æŒ¥ Webpack çš„æ¨¡å—åŒ–æ•ˆèƒ½ã€‚
