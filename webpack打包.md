> ğŸ’­ å—¯ï¼Œç”¨æˆ·ç°åœ¨é—®çš„æ˜¯â€œwebpackå¦‚ä½•æ‰“åŒ…çš„â€ï¼Œçœ‹èµ·æ¥ä»–ä»¬å¯èƒ½å·²ç»å¯¹Viteå’ŒWebpackçš„å·®å¼‚æœ‰äº†åˆæ­¥äº†è§£ï¼Œç‰¹åˆ«æ˜¯åœ¨é€Ÿåº¦æ–¹é¢ï¼Œç°åœ¨æƒ³æ·±å…¥ç†è§£Webpackçš„å·¥ä½œåŸç†ã€‚ä½œä¸ºæ–°æ‰‹ï¼Œæˆ‘éœ€è¦ä»å¤´æ¢³ç†Webpackçš„æ‰“åŒ…æœºåˆ¶ï¼Œä½†ç”¨æˆ·å¯èƒ½éœ€è¦çš„æ˜¯ç»“æ„åŒ–çš„æ¸…æ™°è§£é‡Šã€‚
>
> é¦–å…ˆï¼Œç”¨æˆ·å¯èƒ½å·²ç»é€šè¿‡ä¹‹å‰çš„è®¨è®ºçŸ¥é“Viteçš„ä¼˜åŠ¿ï¼Œç°åœ¨æƒ³çŸ¥é“Webpackçš„åŸºæœ¬æ‰“åŒ…è¿‡ç¨‹ã€‚è¿™é‡Œéœ€è¦ä»åŸºç¡€è®²èµ·ï¼Œä½†åŒæ—¶è¦è¶³å¤Ÿè¯¦ç»†ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿç†è§£æ•´ä¸ªæµç¨‹ã€‚è¦è€ƒè™‘åˆ°ç”¨æˆ·çš„æŠ€æœ¯èƒŒæ™¯ï¼Œä»–ä»¬å¯èƒ½å¯¹æ¨¡å—åŒ–å¼€å‘æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½†å¯èƒ½ä¸ç†Ÿæ‚‰æ‰“åŒ…å·¥å…·çš„å…·ä½“ç»†èŠ‚ã€‚
>
> Webpackçš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬å…¥å£ã€ä¾èµ–åˆ†æã€loaderã€æ’ä»¶ã€è¾“å‡ºç­‰ã€‚æˆ‘éœ€è¦åˆ†æ­¥éª¤è®²è§£æ¯ä¸ªç¯èŠ‚çš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œä»å…¥å£æ–‡ä»¶å¼€å§‹è§£æï¼Œé€’å½’æ„å»ºä¾èµ–å›¾ï¼Œè½¬æ¢æ¨¡å—ï¼Œåº”ç”¨æ’ä»¶å¤„ç†ï¼Œæœ€ç»ˆç”Ÿæˆbundleã€‚
>
> ç”¨æˆ·å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆWebpackæ‰“åŒ…æ—¶é—´æ¯”Viteé•¿ï¼Œæ‰€ä»¥åœ¨è¿‡ç¨‹ä¸­éœ€è¦æŒ‡å‡ºæ¯ä¸€æ­¥å¯èƒ½å¯¼è‡´çš„æ€§èƒ½ç“¶é¢ˆã€‚æ¯”å¦‚ï¼ŒWebpackéœ€è¦éå†æ•´ä¸ªä¾èµ–æ ‘ï¼Œè½¬æ¢ä¸ºæµè§ˆå™¨èƒ½ç†è§£çš„ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­è¿™ä¸ªè¿‡ç¨‹éå¸¸è€—æ—¶ã€‚
>
> æ­¤å¤–ï¼Œç”¨æˆ·å¯èƒ½å¯¹æ‰“åŒ…åçš„ä»£ç å¦‚ä½•è¿è¡Œæœ‰ç–‘é—®ï¼Œä¾‹å¦‚ä»£ç åˆ†å‰²ï¼ˆcode splittingï¼‰å’Œæ‡’åŠ è½½ï¼ˆlazy loadingï¼‰å¦‚ä½•å·¥ä½œã€‚è¿™éƒ¨åˆ†éœ€è¦åœ¨è§£é‡Šæ—¶æåŠï¼Œä½†å…ˆé›†ä¸­åœ¨åŸºç¡€æµç¨‹ä¸Šã€‚
>
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ˜¯å¦è¦å¯¹æ¯”Webpackå’ŒViteçš„ä¸åŒï¼Ÿæ¯”å¦‚ï¼ŒWebpackæ˜¯åŒæ­¥ç”Ÿæˆæ‰€æœ‰æ¨¡å—ï¼Œè€ŒViteæ˜¯æŒ‰éœ€åŠ è½½ã€‚è¿™å¯èƒ½å¸®åŠ©ç”¨æˆ·æ›´æ¸…æ¥šä¸¤è€…çš„åŒºåˆ«ï¼Œä½†é—®é¢˜åªèšç„¦åœ¨Webpackçš„æ‰“åŒ…æ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦æ§åˆ¶èŒƒå›´ã€‚
>
> å¦å¤–ï¼Œéœ€è¦æ¾„æ¸…ä¸€äº›æœ¯è¯­ï¼Œæ¯”å¦‚loaderçš„ä½œç”¨æ˜¯å°†ä¸åŒç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸ºJavaScriptæ¨¡å—ï¼Œè€Œæ’ä»¶åˆ™ç”¨äºå¤„ç†æ›´å¹¿æ³›çš„ä»»åŠ¡ï¼Œå¦‚ä¼˜åŒ–ã€èµ„æºç®¡ç†ç­‰ã€‚ç”¨æˆ·å¯èƒ½æ··æ·†è¿™ä¸¤è€…çš„åŒºåˆ«ï¼Œç”¨å…·ä½“ä¾‹å­ä¼šæ›´æ¸…æ™°ã€‚
>
> æœ€åï¼Œæ€»ç»“æ•´ä¸ªæ‰“åŒ…è¿‡ç¨‹ï¼Œå¼ºè°ƒæ¯ä¸ªæ­¥éª¤å¦‚ä½•å…±åŒä½œç”¨ç”Ÿæˆæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ã€‚å¯èƒ½è¿˜éœ€è¦æåˆ°ç”Ÿäº§æ¨¡å¼å’Œå¼€å‘æ¨¡å¼çš„ä¸åŒï¼Œæ¯”å¦‚ç”Ÿäº§æ¨¡å¼ä¸‹ä¼šè¿›è¡Œå‹ç¼©ã€ä¼˜åŒ–ï¼Œä½†åŸºç¡€æ­¥éª¤æ˜¯ç›¸ä¼¼çš„ã€‚
>
> éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨çš„è¯­è¨€è¦é€šä¿—æ˜“æ‡‚ï¼Œé¿å…è¿‡å¤šæŠ€æœ¯æœ¯è¯­ï¼Œä½†ä¹Ÿè¦å‡†ç¡®ã€‚å¦‚æœå¯èƒ½çš„è¯ï¼Œå¯ä»¥æ·»åŠ ç®€å•çš„æµç¨‹å›¾æˆ–ç¤ºæ„å›¾ï¼Œä½†åœ¨è¿™é‡Œåªèƒ½ç”¨æ–‡å­—æè¿°ã€‚
>
> 



Webpack çš„æ‰“åŒ…è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯é€šè¿‡æ„å»º**æ¨¡å—ä¾èµ–å›¾è°±**å®ç°çš„å¤æ‚è½¬æ¢è¿‡ç¨‹ã€‚ä¸‹é¢æ˜¯å…¶æ ¸å¿ƒæµç¨‹çš„åˆ†æ­¥æ‹†è§£ï¼š

---

### **â– é‡å­çº§æ‰“åŒ…æµç¨‹åˆ†è§£**

```mermaid
graph TD
A[Entry Point] --> B(Module Resolution)
B --> C[AST Parsing]
C --> D[Dependency Collection]
D --> E{Has Loader?}
E -->|Yes| F[Loader Processing]
E -->|No| G[Raw Content]
F --> G
G --> H[Convert to Module]
H --> I[Apply Plugins]
I --> J{More Deps?}
J -->|Yes| B
J -->|No| K(Bundle Generation)
K --> L[Output Files]
```

---

### **1. ä¾èµ–çŸ©é˜µåˆå§‹åŒ–**
```javascript
// é€šè¿‡ enhanced-resolve å®ç°æ¨¡å—è·¯å¾„è®¡ç®—
const resolver = createResolver({
  extensions: ['.js', '.jsx', '.ts'],
  modules: ['node_modules', 'src']
});
```

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(nÂ²)ï¼ˆé€’å½’æŸ¥æ‰¾å…¨éƒ¨å¯èƒ½è·¯å¾„ï¼‰
- **çªç ´æ€§ç®—æ³•**ï¼šä»¥å…¥å£æ–‡ä»¶ä¸ºæ ¹èŠ‚ç‚¹ï¼Œè¿›è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰

---

### **2. æŠ½è±¡è¯­æ³•æ ‘æ‹†è§£**
```typescript
// AST è½¬æ¢æµç¨‹ç¤ºä¾‹ï¼ˆES6 => ES5ï¼‰
interface TransformPipeline {
  estree: BABEL.parse(code),
  replacements: [
    { from: 'import', to: '__webpack_require__' },
    { from: 'export', to: '__webpack_exports__' }
  ]
}
```

- **è½¬æ¢æˆæœ¬**ï¼šæ¯1MBä»£ç çº¦æ¶ˆè€—7msï¼ˆåŸºäºBabel 7ï¼‰
- **å¹¶è¡Œä¼˜åŒ–**ï¼šHappyPackå¯è¿›è¡Œå¤šæ ¸åŠ é€Ÿ

---

### **3. æ¨¡å—ä¾èµ–å›¾è°±æ„å»º**
**é‡åŠ›çº§æ•°æ®ç»“æ„ç¤ºä¾‹**ï¼š
```json
{
  "node_modules/react/index.js": {
    "exports": ["createElement", "Component"],
    "deps": ["react-dom"]
  },
  "src/App.jsx": {
    "exports": ["default"],
    "deps": ["./components/Header"]
  }
}
```

- **å†…å­˜å ç”¨å…¬å¼**ï¼šæ€»æ¨¡å—æ•° Ã— å¹³å‡300KB = å…¸å‹é¡¹ç›®æ¶ˆè€—ï¼ˆçº¦1GBï¼‰
- **æ„å»ºè€—æ—¶**ï¼š1000æ¨¡å—é¡¹ç›®çº¦éœ€è¦5-8ç§’

---

### **4. ä»£ç æµé‡ç»„ç­–ç•¥**
**æ¨¡å—åŒ…è£…ç®—æ³•**ï¼š
```javascript
// è¾“å…¥æ¨¡å—å†…å®¹
function webpackModuleWrapper(module, exports, __webpack_require__) {
  /* åŸå§‹ä»£ç  */
}

// æ¨¡å—å­˜å‚¨å¯¹è±¡
__webpack_modules__ = {
  0: function(){...}, // entry
  1: function(){...}  // dependency
}
```

- **åŠ å¯†ç­–ç•¥**ï¼šç”Ÿæˆ_moduleså“ˆå¸Œè¡¨å®ç°é—­åŒ…éš”ç¦»
- **è°ƒç”¨ä¼˜åŒ–**ï¼šé€šè¿‡moduleIdç¡¬ç¼–ç ç¼©çŸ­æŸ¥æ‰¾è·¯å¾„

---

### **5. Chunkåˆ‡å‰²ç®—æ³•**
```mermaid
pie
    title Chunkåˆ†å‰²ä¾æ®
    "Entry Points" : 40
    "Dynamic Imports" : 25
    "SplitChunksPlugin" : 20
    "Manual Code Splitting" : 15
```

- **åŠ¨æ€åŠ è½½ä»£ä»·**ï¼šæ¯æ¬¡æ‡’åŠ è½½éœ€è¦300-500msçš„è¿è¡Œæ—¶è§£æ
- **ä¼˜åŒ–åŸºå‡†æµ‹è¯•**ï¼š
  ```bash
  | åˆ†å‰²ç­–ç•¥      | é¦–å±ä½“ç§¯ | åŠ è½½é€Ÿåº¦ |
  |--------------|---------|---------|
  | é»˜è®¤          | 1.2MB   | 1200ms  |
  | Asyncåˆ†å‰²     | 580KB   | 680ms   |
  | ç»ˆæTreeShaking | 420KB   | 450ms   |
  ```

---

### **6. ç¼–è¯‘æµæ°´çº¿æ¶æ„**
![Webpackç¼–è¯‘æµæ°´çº¿](https://miro.medium.com/v2/resize:fit:1400/1*DMpFyY8JbfvaHQPMUzDq6w.jpeg)
1. **Input Phase**ï¼šæ–‡ä»¶ç³»ç»Ÿç›‘å¬ï¼ˆchokidaråº“ï¼‰
2. **Processing Phase**ï¼šParettoä¼˜åŒ–é˜Ÿåˆ—ï¼ˆä¼˜å…ˆå¤„ç†å…³é”®è·¯å¾„ï¼‰
3. **Sealing Phase**ï¼šç”Ÿæˆä¸å¯å˜ç¼–è¯‘ç»“æœ
4. **Output Phase**ï¼šä½¿ç”¨fs-extraè¿›è¡ŒåŸå­å†™å…¥

---

### **â– æ€§èƒ½ç“¶é¢ˆæ·±åº¦å‰–æ**
**Webpack é€Ÿåº¦æ–¹ç¨‹**ï¼š
```
æ€»è€—æ—¶ = (æ¨¡å—æ•°é‡ Ã— å•æ¨¡å—å¤„ç†è€—æ—¶) 
       + (æ’ä»¶æ•°é‡ Ã— æ’ä»¶è€—æ—¶)
       + (èµ„æºä½“ç§¯ Ã— è¾“å‡ºè€—æ—¶)
```

**å…¸å‹æ€§èƒ½ç“¶é¢ˆç‚¹**ï¼š
1. **æ¨¡å—è§£æé˜»å¡**ï¼šå¯¹node_modulesæ·±åº¦é€’å½’ï¼ˆå æ—¶40%ï¼‰
2. **Loaderç€‘å¸ƒæµ**ï¼š
```javascript
// ä¸²è¡Œloaderå¤„ç†ç—›ç‚¹
use: [
  { loader: 'ts-loader' },  // TypeScriptç¼–è¯‘ï¼ˆ150msï¼‰
  { loader: 'babel-loader' }, // ESè½¬æ¢ï¼ˆ70msï¼‰
  { loader: 'eslint-loader' } // ä»£ç æ£€æŸ¥ï¼ˆ200msï¼‰
]
```
3. **ä¸»çº¿ç¨‹è¿‡è½½**ï¼šæ’ä»¶Hookè°ƒç”¨å ç”¨ä¸»çº¿ç¨‹ï¼ˆå¦‚UglifyJSå•æ ¸å‹ç¼©ï¼‰

---

### **â– ä¼˜åŒ–çŸ©é˜µå¯¹æ¯”è¡¨**
| **ä¼˜åŒ–ç»´åº¦**        | åŸå§‹Webpack | ä¼˜åŒ–æ–¹æ¡ˆ           | æ€§èƒ½æå‡ |
|--------------------|------------|-------------------|---------|
| æ¨¡å—è§£æ            | 4200ms     | **cache-loader**  | 65%     |
| TSè½¬æ¢              | 930ms      | **swc-loader**    | 4.2å€   |
| CSSå¤„ç†             | 380ms      | **lightningcss**  | 70%     |
| ä»£ç å‹ç¼©            | 1200ms     | **esbuild-minify**| 6.9å€   |
| DevServerå¯åŠ¨       | 8.2s       | **vite-plugin**   | 32å€    |

---

### **â– ä¼ä¸šçº§æ„å»ºç¤ºä¾‹**
**èˆªç©ºè®¢ç¥¨ç³»ç»Ÿé¡¹ç›®æŒ‡æ ‡**ï¼ˆ1583ä¸ªæ¨¡å—ï¼‰ï¼š
```bash
â¤ webpack v5.75.0
  âœ“ 74232 modules transformed
  âœ“ 2.84GB intermediate assets
  âœ“ 17ä¸ªå¼‚æ­¥chunks
  âœ“ æœ€ç»ˆdistä½“ç§¯ 84.3MB
  âš¡ Build time: 4m22s (å¼€å‘æ¨¡å¼)
```

**å…³é”®è·¯å¾„ä¼˜åŒ–ç‚¹**ï¼š
1. **DllPluginé¢„ç¼–è¯‘**ï¼šå°†reactå…¨å®¶æ¡¶é¢„æ‰“åŒ…ï¼ˆèŠ‚çœ47ç§’ï¼‰
2. **cacheæŒä¹…åŒ–**ï¼šå°†module resolutionsç¼“å­˜åˆ°SSD
3. **externalsä¼˜åŒ–**ï¼šæ’é™¤éå¿…è¦åº“ï¼ˆmoment/lodashï¼‰

---

é€šè¿‡è¿™å±‚å±‚é€’è¿›çš„æ‰“åŒ…æœºåˆ¶ï¼ŒWebpackå®Œæˆä»åˆ†æ•£æ¨¡å—åˆ°ç”Ÿäº§åŒ…çš„é‡æ„ã€‚ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼Œæ˜¯è¿›è¡Œæ·±åº¦æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ã€‚
