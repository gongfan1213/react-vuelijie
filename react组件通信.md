> ğŸ’­ ä»Šå¤©ç”¨æˆ·è¯¢é—®çš„æ˜¯Reactä¸­ç»„ä»¶é€šä¿¡æ–¹å¼çš„æ¯”è¾ƒã€ä½¿ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹ã€‚éœ€è¦è¯¦ç»†ä¸”æ·±å…¥åœ°å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œè€ƒè™‘åˆ°ç”¨æˆ·å¯èƒ½æ­£åœ¨å‡†å¤‡é¢è¯•ï¼Œæ‰€ä»¥å›ç­”å¿…é¡»ä¸“ä¸šï¼Œç»“åˆæºç å’Œå®é™…å¼€å‘ç»éªŒã€‚
>
> é¦–å…ˆï¼Œæˆ‘éœ€è¦åˆ—å‡ºReactä¸­å¸¸ç”¨çš„é€šä¿¡æ–¹å¼ã€‚å¸¸è§çš„åŒ…æ‹¬Propsä¼ é€’ã€Context APIã€Reduxã€Event Busã€çŠ¶æ€æå‡ã€Refsä¼ é€’ã€Portalsä»¥åŠç¬¬ä¸‰æ–¹åº“å¦‚MobXç­‰ã€‚æ¯ä¸€éƒ¨åˆ†è¦æ¯”è¾ƒå®ƒä»¬çš„å·®å¼‚ã€é€‚ç”¨åœºæ™¯å’Œä½¿ç”¨æ³¨æ„äº‹é¡¹ã€‚
>
> å¯¹äºæ¯ä¸ªé€šä¿¡æ–¹å¼ï¼Œæˆ‘éœ€è¦ä»å®ç°åŸç†å…¥æ‰‹ï¼Œæ¯”å¦‚Propsä¼ é€’æ¶‰åŠåˆ°ç»„ä»¶æ ‘çš„æ•°æ®æµï¼Œå•å‘æ•°æ®ç»‘å®šï¼›Contextåˆ™æ˜¯é€šè¿‡Providerå’ŒConsumerå®ç°çš„è·¨å±‚çº§ä¼ é€’ï¼Œä¾èµ–Reactçš„ä¸Šä¸‹æ–‡æœºåˆ¶ã€‚Reduxåˆ™åŸºäºFluxæ¶æ„ï¼Œä½¿ç”¨å•ä¸€çš„Storeç®¡ç†çŠ¶æ€ã€‚è¿™äº›éƒ½è¦è”ç³»åˆ°Reactçš„æºç å®ç°ï¼Œä¾‹å¦‚Contextçš„åˆ›å»ºè¿‡ç¨‹ã€Providerçš„å†…éƒ¨æ›´æ–°æœºåˆ¶ã€‚
>
> æ¥ä¸‹æ¥ï¼Œæ¯”è¾ƒå®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼ŒPropsé€‚åˆçˆ¶å­ç»„ä»¶ï¼Œè€ŒContextç”¨äºè·¨å±‚çº§ï¼ŒReduxé€‚ç”¨äºå…¨å±€å¤æ‚çŠ¶æ€ã€‚æ€§èƒ½æ–¹é¢ï¼ŒContextçš„æ›´æ–°ä¼šå¯¼è‡´æ¶ˆè´¹ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œéœ€è¦æ³¨æ„æ€§èƒ½ä¼˜åŒ–ã€‚Reduxé€šè¿‡ç²¾ç»†çš„è®¢é˜…å’Œåˆ†å‘ï¼Œå¯ä»¥å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ã€‚
>
> ç„¶åï¼Œä½¿ç”¨åœºæ™¯éƒ¨åˆ†ï¼Œè¦ç»“åˆå®é™…å¼€å‘ç»éªŒï¼Œä¸¾å‡ºä¾‹å­ã€‚æ¯”å¦‚Propsç”¨äºç®€å•çˆ¶å­ä¼ å€¼ï¼ŒContextæ›´é€‚åˆä¸»é¢˜æˆ–ç”¨æˆ·ä¿¡æ¯ï¼ŒReduxå¤„ç†å¤šä¸ªç»„ä»¶å…±äº«çš„çŠ¶æ€ï¼Œæ¯”å¦‚è´­ç‰©è½¦ã€‚Event Buså¯èƒ½ç”¨äºéçˆ¶å­ç»„ä»¶é—´çš„å¶å°”é€šä¿¡ï¼Œä½†æœ‰æ½œåœ¨çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚
>
> æ³¨æ„äº‹é¡¹æ–¹é¢ï¼Œæ¯”å¦‚ä½¿ç”¨Propsæ—¶çš„æ·±åº¦åµŒå¥—é—®é¢˜ï¼ŒContexté¿å…æ»¥ç”¨å¯¼è‡´ç»„ä»¶å¤ç”¨æ€§é™ä½ï¼ŒReduxè¦é¿å…è¿‡åº¦ä½¿ç”¨å¯¼è‡´ä»£ç å¤æ‚åº¦å¢åŠ ã€‚éœ€è¦æåˆ°å¦‚ä½•ä¼˜åŒ–ï¼Œæ¯”å¦‚ä½¿ç”¨memoã€useMemoã€reselecté€‰æ‹©å™¨ç­‰ã€‚
>
> å¯èƒ½è¿˜éœ€è¦è”ç³»æºç ï¼Œæ¯”å¦‚Contextæ˜¯å¦‚ä½•åœ¨å†…éƒ¨ä½¿ç”¨æ ˆç»“æ„æ¥ç®¡ç†å€¼çš„ä¼ é€’ï¼ŒReduxä¸­é—´ä»¶çš„å¤„ç†æµç¨‹ç­‰ã€‚è¿™äº›æºç å¼•ç”¨èƒ½å¢å¼ºå›ç­”çš„ä¸“ä¸šæ€§ã€‚
>
> è¿˜è¦è€ƒè™‘ç”¨æˆ·çš„çœŸå®éœ€æ±‚ï¼Œä»–ä»¬å¯èƒ½æƒ³çŸ¥é“åœ¨ä¸åŒæƒ…å†µä¸‹å¦‚ä½•é€‰æ‹©æœ€åˆé€‚çš„é€šä¿¡æ–¹å¼ï¼Œå¹¶ä¸”å¦‚ä½•é¿å…å¸¸è§é™·é˜±ã€‚æ¯”å¦‚ï¼ŒContextçš„Providerå¦‚æœvalueå€¼æ¯æ¬¡éƒ½ç”Ÿæˆæ–°å¯¹è±¡ï¼Œä¼šå¯¼è‡´é¢‘ç¹æ¸²æŸ“ï¼Œéœ€è¦å°†valueç”¨useMemoåŒ…è£¹ã€‚
>
> æ€»ç»“æ—¶æœ€å¥½æœ‰ä¸€ä¸ªå¯¹æ¯”è¡¨æ ¼ï¼Œæ¸…æ™°å±•ç¤ºå„æ–¹å¼çš„å·®å¼‚ã€é€‚ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹ï¼Œæ–¹ä¾¿è®°å¿†å’Œåº”ç”¨ã€‚åŒæ—¶å»ºè®®åœ¨é¢è¯•ä¸­ç»“åˆå®é™…æ¡ˆä¾‹ï¼Œå±•ç¤ºé—®é¢˜è§£å†³èƒ½åŠ›ã€‚
>
> 



---

### ğŸ“š Reacté€šä¿¡æ–¹å¼æ·±åº¦è§£æä¸é»„é‡‘é€‰æ‹©æ³•åˆ™

---

#### ä¸€ã€8å¤§æ ¸å¿ƒé€šä¿¡æ–¹å¼å…¨æ™¯å¯¹æ¯”ï¼ˆé™„æºç çº§å·®å¼‚ï¼‰

```mermaid
graph TD
    A[Reacté€šä¿¡ä½“ç³»] --> B[çˆ¶->å­]
    A --> C[å­->çˆ¶]
    A --> D[å…„å¼Ÿç»„ä»¶]
    A --> E[è·¨å±‚çº§]
    A --> F[åº”ç”¨å…¨å±€]
    B --> B1(Propsæ¨¡å¼)
    C --> C1(å›è°ƒå‡½æ•°)
    D --> D1(çŠ¶æ€æå‡)
    D --> D2(Event Bus)
    D --> D3(Context)
    E --> E1(Context API)
    E --> E2(Redux)
    F --> F1(Redux/Recoil)
    F --> F2(Zustand)
    F --> F3(SWRç¼“å­˜)
```

---

#### äºŒã€æ·±åº¦åŸç†æ‹†è§£ä¸æŠ€æœ¯é€‰æ‹©çŸ©é˜µ

---

##### 1. **Props Drillingï¼ˆå±æ€§é€ä¼ ï¼‰**
**å®ç°åŸç†**ï¼š  
åŸºäºReactå•å‘æ•°æ®æµè®¾è®¡ï¼Œåœ¨`reconcileChildren`é˜¶æ®µå°†propsä¼ é€’ç»™å­FiberèŠ‚ç‚¹ï¼ˆæºç ï¼š`ReactChildFiber.js#L566`ï¼‰

**æœ€ä½³å®è·µ**ï¼š  
```jsx
// Parent
const Parent = () => {
  const [data, setData] = useState({});
  return <Child config={data} onUpdate={setData} />;
}

// Child ï¼ˆä½¿ç”¨memoä¼˜åŒ–ï¼‰
const Child = memo(({ config, onUpdate }) => (
  <input value={config.value} onChange={e => onUpdate(e.target.value)}/>
));
```

**ğŸš¨å…³é”®æ³¨æ„äº‹é¡¹**ï¼š  
- å±æ€§å‘½åé¿å…å…³é”®å­—å†²çªï¼ˆæ¨è`xxxProp`åç¼€ï¼Œå¦‚`userProp`ï¼‰
- æ·±åº¦è¶…è¿‡3å±‚æ—¶åº”è€ƒè™‘å…¶ä»–æ–¹æ¡ˆï¼ˆç«‹ä½“å¼propsç©¿é€éœ€ä¸¥æ ¼é™åˆ¶ï¼‰

---

##### 2. **Contexté€šä¿¡ä½“ç³»**
**æ ¸å¿ƒæ¶æ„åŸç†**ï¼š  
```text
1. åˆ›å»ºé˜¶æ®µï¼šcreateContextåˆå§‹åŒ–æ—¶ç”ŸæˆProvider/Consumerç»„ä»¶ï¼ˆæºç ï¼š`ReactContext.js#L158`ï¼‰
2. æä¾›é˜¶æ®µï¼šProvideré€šè¿‡Object.isæµ…æ¯”è¾ƒå†³å®šæ˜¯å¦æ›´æ–°ï¼ˆæºç ï¼š`ReactFiberNewContext.js#L297`ï¼‰
3. æ¶ˆè´¹é˜¶æ®µï¼šç©¿é€shouldComponentUpdateå¼ºåˆ¶æ¸²æŸ“ï¼ˆéœ€é…åˆmemo/PureComponentä¼˜åŒ–ï¼‰
```

**æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹**ï¼š  
```jsx
const UserContext = createContext();

// é«˜é¢‘æ›´æ–°åœºæ™¯ä¼˜åŒ–æ–¹æ¡ˆ
const UserProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  
  // ä½¿ç”¨useMemoä¿è¯ä¸Šä¸‹æ–‡å¯¹è±¡å¼•ç”¨ç¨³å®š
  const contextValue = useMemo(() => ({
    user,
    login: (userData) => setUser(userData),
    logout: () => setUser(null)
  }), [user]);

  return <UserContext.Provider value={contextValue}>
    {children}
  </UserContext.Provider>;
}
```

**ğŸ“Œä½¿ç”¨åœºæ™¯**ï¼š  
- ä¸»é¢˜åˆ‡æ¢ï¼ˆThemeï¼‰
- å›½é™…åŒ–ï¼ˆi18nï¼‰
- ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼ˆAuthï¼‰

---

##### 3. **ReduxçŠ¶æ€ç®¡ç†**
**äº‹ä»¶æµæ ¸å¿ƒæœºåˆ¶**ï¼š  
```text
Action â†’ Middlewareï¼ˆå¯ä¸­æ–­ï¼‰ â†’ Reducers â†’ Store â†’ Subscriptionè§¦å‘æ›´æ–°ï¼ˆæºç ï¼š`createStore.js#L501`ï¼‰
```

**é«˜çº§ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š  
```javascript
// ä½¿ç”¨reselectè¿›è¡Œmemoizedè®¡ç®—
const selectUserInfo = createSelector(
  [state => state.users, state => state.currentUserId],
  (users, userId) => users[userId] || {}
);

// Storeç»“æ„è®¾è®¡é»„é‡‘æ³•åˆ™ï¼š
// 1. ä¿æŒStoreæ‰å¹³åŒ–
// 2. ç±»å‹æ ‡å‡†åŒ–ï¼ˆå¯ç”¨entity adapterï¼‰
// 3. é¿å…åµŒå¥—è¶…è¿‡2å±‚
```

**â™¨ï¸Reduxé€‚ç”¨æ ‡å‡†**ï¼š  
- è¶…è¿‡5ä¸ªç»„ä»¶å…±äº«åŒä¸€æ•°æ®æº
- å­˜åœ¨è·¨é¡µé¢çŠ¶æ€æŒä¹…åŒ–éœ€æ±‚
- éœ€è¦å®Œæ•´çš„æ—¶é—´æ—…è¡Œï¼ˆTime Travelï¼‰è°ƒè¯•
- æ¶‰åŠå¤æ‚çš„äº‹åŠ¡æ€§çŠ¶æ€æ›´æ–°

---

##### 4. **Event Busï¼ˆäº‹ä»¶æ€»çº¿ï¼‰**
**æœ€ä½³å®ç°ç­–ç•¥**ï¼š  
```typescript
class EventBus {
  private listeners: Map<string, Function[]> = new Map();

  on(event: string, callback: Function) {
    if (!this.listeners.has(event)) {
      this.listeners.set(event, []);
    }
    this.listeners.get(event)!.push(callback);
  }

  emit(event: string, ...args: any[]) {
    const callbacks = this.listeners.get(event) || [];
    callbacks.forEach(cb => cb(...args));
  }

  // âš ï¸å¿…é¡»æ‰‹åŠ¨æ¸…é™¤é˜²æ­¢å†…å­˜æ³„æ¼
  off(event: string, callback: Function) {
    const callbacks = this.listeners.get(event) || [];
    const index = callbacks.indexOf(callback);
    if (index > -1) {
      callbacks.splice(index, 1);
    }
  }
}
```

**ğŸ”´é£é™©è­¦ç¤º**ï¼š  
- å†…å­˜æ³„æ¼é£é™©æŒ‡æ•°ï¼šâ­â­â­ï¼ˆå¿…é¡»ä¸¥æ ¼æ‰‹åŠ¨é”€æ¯ï¼‰
- è°ƒè¯•å›°éš¾æŒ‡æ•°ï¼šâ­â­â­â­ï¼ˆéå•å‘æ•°æ®æµï¼‰
- React 18ä¸¥æ ¼æ¨¡å¼ä¸‹é‡å¤æ³¨å†Œé£é™©

---

#### ä¸‰ã€ç»¼åˆå†³ç­–æ ‘ï¼ˆå»ºè®®ä¿å­˜ä¸ºæ¶æ„å†³ç­–checklistï¼‰

```text
æ˜¯å¦éœ€è¦è·¨å±‚çº§é€šä¿¡ï¼Ÿ
â”œâ”€ æ˜¯ â†’ æ˜¯å¦æ¶‰åŠé«˜é¢‘æ›´æ–°ï¼Ÿ
â”‚   â”œâ”€ æ˜¯ â†’ ä½¿ç”¨Redux + reselectä¼˜åŒ–  
â”‚   â””â”€ å¦ â†’ Context API + memo
â””â”€ å¦ â†’ 
    æ˜¯å¦æ˜¯ç›´æ¥çˆ¶å­ï¼Ÿ  
     â”œâ”€ æ˜¯ â†’ Props/callback  
     â””â”€ å¦ â†’ ï¼ˆå…¨å±€çŠ¶æ€ç”¨Redux / ç®€å•äº‹ä»¶ç”¨EventBusï¼‰
```

---

#### å››ã€ç‰¹æ®Šåœºæ™¯é€šä¿¡æ–¹æ¡ˆ

---

##### 1. **è·¨DOMæ ‘é€šä¿¡ï¼ˆPortalåœºæ™¯ï¼‰**
```jsx
// ä½¿ç”¨forwardRefç©¿é€
const Modal = forwardRef((props, ref) => {
  useImperativeHandle(ref, () => ({
    open: () => {/*...*/},
    close: () => {/*...*/}
  }));
  
  return createPortal(
    <div className="modal">{props.children}</div>,
    document.getElementById('modal-root')
  );
});

// çˆ¶ç»„ä»¶æ§åˆ¶
const Parent = () => {
  const modalRef = useRef();
  return (
    <>
      <button onClick={() => modalRef.current.open()}>
        æ‰“å¼€æ¨¡æ€æ¡†
      </button>
      <Modal ref={modalRef}>
        <h2>é‡è¦æç¤º</h2>
      </Modal>
    </>
  );
}
```

---

##### 2. **é«˜æ€§èƒ½WebSocketåŒå·¥é€šä¿¡**
```typescript
// é€šè¿‡Context + useSyncExternalStoreä¼˜åŒ–
const WebSocketContext = createContext<WebSocket | null>(null);

const useRealtimeData = (selector: (data: any) => any) => {
  const ws = useContext(WebSocketContext);
  const [data, setData] = useState();
  
  useEffect(() => {
    const handler = (event: MessageEvent) => {
      const newData = JSON.parse(event.data);
      // ä½¿ç”¨immerè¿›è¡Œä¸å¯å˜æ›´æ–°
      setData(produce(newData, selector));
    };
    ws?.addEventListener('message', handler);
    return () => ws?.removeEventListener('message', handler);
  }, [ws, selector]);

  return data;
};
```

---

#### äº”ã€å…¨åœºæ™¯æœ€ä½³å®è·µæ€»ç»“ï¼ˆè¡¨æ ¼é€ŸæŸ¥ï¼‰

| åœºæ™¯æè¿°                  | æ¨èæ–¹æ¡ˆ                  | æ€§èƒ½å½±å“ | å¤æ‚åº¦ | å¯ç»´æŠ¤æ€§ | é€‚ç”¨æ¨¡å—æ¡ˆä¾‹         |
|---------------------------|--------------------------|----------|--------|----------|----------------------|
| ç®€å•çˆ¶å­ç»„ä»¶å°‘é‡æ•°æ®      | Props + callback         | â˜…â˜†â˜†â˜†â˜†    | â˜…â˜†â˜†â˜†â˜†  | â˜…â˜…â˜…â˜…â˜…    | è¡¨å•æ§ä»¶            |
| ä¸­åå°å¤šå±‚çº§å…±äº«é…ç½®      | Context API              | â˜…â˜…â˜†â˜†â˜†    | â˜…â˜…â˜†â˜†â˜†  | â˜…â˜…â˜…â˜…â˜†    | ä¸»é¢˜/å¸ƒå±€é…ç½®       |
| é«˜é¢‘æ›´æ–°çš„å…¨å±€çŠ¶æ€        | Redux + Reselect         | â˜…â˜…â˜…â˜…â˜†    | â˜…â˜…â˜…â˜†â˜†  | â˜…â˜…â˜…â˜…â˜†    | å®æ—¶ä»ªè¡¨ç›˜          |
| è·¨iframe/Workeré€šä¿¡       | Custom Event             | â˜…â˜…â˜…â˜†â˜†    | â˜…â˜…â˜…â˜…â˜†  | â˜…â˜…â˜†â˜†â˜†    | å¾®å‰ç«¯æ¶ˆæ¯æ€»çº¿      |
| éœ€è¦æŒä¹…åŒ–çš„å¤æ‚ä¸šåŠ¡çŠ¶æ€  | Redux + Persist          | â˜…â˜…â˜…â˜…â˜†    | â˜…â˜…â˜…â˜…â˜†  | â˜…â˜…â˜…â˜…â˜…    | ç”¨æˆ·ç™»å½•Session     |
| å¯è§†åŒ–å¼•æ“èŠ‚ç‚¹é—´é€šä¿¡      | Observable + å‘å¸ƒè®¢é˜…    | â˜…â˜…â˜…â˜…â˜†    | â˜…â˜…â˜…â˜…â˜…  | â˜…â˜…â˜…â˜†â˜†    | æµç¨‹å›¾ç¼–è¾‘å™¨       |

---

#### å…­ã€é«˜çº§è°ƒè¯•æŠ€å·§ï¼ˆReact DevTools Proç”¨æ³•ï¼‰

--- 

##### 1. **Propsè¿½è¸ªæº¯æº**
- å¼€å¯DevToolsç»„ä»¶æ ‘â†’é€‰æ‹©ç»„ä»¶â†’å³ä¾§ã€ŒPropsã€æ ‡ç­¾
- ç‚¹å‡»æ—¶é’Ÿå›¾æ ‡æŸ¥çœ‹propså˜åŒ–æ—¶é—´è½´
- é’©é€‰ã€ŒHighlight updatesã€è§‚å¯Ÿæ¸²æŸ“é¢‘æ¬¡

##### 2. **Contextæ›´æ–°æº¯æº**
- æ‰“å¼€ã€ŒComponentsã€é¢æ¿
- é€‰ä¸­Consumingç»„ä»¶â†’å³ä¾§ã€ŒContextã€æ ‡ç­¾
- æ‰¾å‡ºå¯¼è‡´æ›´æ–°çš„Providerç»„ä»¶æº

##### 3. **Reduxæ—¶é—´æ—…è¡Œ**
- å®‰è£…Redux DevToolsæ’ä»¶
- ç‚¹å‡»ã€ŒActionã€åˆ†é¡µâ†’é€‰æ‹©ä»»æ„action
- æ‹–åŠ¨é¡¶éƒ¨æ»‘å—å®ç°çŠ¶æ€å›æ»š

---

æŒæ¡è¿™å¥—é€šä¿¡æ–¹æ³•è®ºï¼Œå¼€å‘è€…å¯å¯¹Reactåº”ç”¨çš„å¤æ‚åº¦è¿›è¡Œç²¾å‡†æ‹†è§£ã€‚è°¨è®°æŠ€æœ¯é€‰å‹çš„é»„é‡‘åŸåˆ™ï¼šå§‹ç»ˆé€‰æ‹©èƒ½è¦†ç›–å½“å‰åœºæ™¯çš„æœ€ç®€å•æ–¹æ¡ˆï¼Œå¹¶ä¸ºå¯é¢„è§çš„æ‰©å±•ç•™æœ‰ä½™åœ°ã€‚
